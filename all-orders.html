<!DOCTYPE html>
<html ng-app="order">

	<head>
		<meta charset="utf-8">
		<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black" />
		<meta name="format-detection" content="telephone=no, email=no" />
		<link rel="stylesheet" type="text/css" href="css/order-tracking.css" />
		<link rel="stylesheet" type="text/css" href="css/new-orders.css" />
		<link rel="stylesheet" type="text/css" href="css/base.css" />
		<link rel="stylesheet" type="text/css" href="css/pullToRefresh.css" />
		<script src="js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/base.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/loading.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/angular.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/iscroll.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/pullToRefresh.js" type="text/javascript" charset="utf-8"></script>
		<title>全部订单</title>
		<style type="text/css">
			.new-order-content {
				margin-top: 100px;
			}
		</style>
	</head>

	<body>
		<div id="header">
			<a href="javascript:history.go(-1)">
				<div class="back"><img src="images/left-arrow.png" class="left-arrow"></div>
			</a>订单查询</div>
		<ul class="menu">
			<li class="current">全部订单</li>
			<li>
				<a href="order-tracking.html">搜索</a>
			</li>
			<li>
				<a href="unpaid-orders.html">待支付订单</a>
			</li>
		</ul>
		<div class="new-order-content" ng-controller="getOrderList" id="wrapper">
			<ul>
				<li ng-repeat="data in data">
					<a ng-href="order-details.html?id={{data.orderId}}">
						<div class="new-order-content-item">
							<div class="new-order-content-top">
								<div class="content-item-left">
									<img ng-src="{{data.orderPic}}" />
								</div>
								<div class="content-item-center">
									<div class="content-item-center-top1">订单编号：{{data.orderNumber}}</div>
									<div class="content-item-center-top2">下单时间：{{data.createTime}}</div>
									<div class="content-item-center-text">收货人：{{data.receivedName}}&nbsp;{{data.receivedPhone}}</div>
									<div class="content-item-center-text">收货地址：{{data.receivedAddress}}</div>
								</div>
								<div class="content-item-right">
									<img src="images/right-arrow.png" />
								</div>
								<div style="clear:both;"></div>
							</div>
							<div class="new-order-content-bottem">
								<div class="new-order-content-bottem-left">￥{{data.realPrice}}</div>
								<div class="new-order-content-bottem-right">订单状态：<span>{{data.orderStateName}}</span></div>
								<div style="clear:both;"></div>
							</div>
						</div>
					</a>
				</li>
			</ul>
		</div>
	</body>
	<script type="text/javascript">
		if(getcookie("token") != "") {
			var order = angular.module('order', []);
			order.controller('getOrderList', function($http, $scope) {
				$http.get(server + "api/order/serchOrderList?accessToken=" + getcookie("token") + "&queryType=3" + must_send).success(function(data) {
					if(data.code == 0) {
						$scope.data = data.data;
					} else {
						meibao_alert(data.message);
					}
				});
			});
		} else {
			window.location.href = "login.html";
		}
	</script>
	<script type="text/javascript">
		refresher.init({
			id: "wrapper",
			pullDownAction: refresh,
			pullUpAction: loadMore
		});
		var generatedCount = 0;

		function refresh() {
			setTimeout(function() { // <-- Simulate network congestion, remove setTimeout from production!
				window.location.reload();//刷新页面
				wrapper.refresh(); /****remember to refresh after  action completed！ ---yourId.refresh(); ----| ****/
			}, 1000);

		}

		function loadMore() {
			setTimeout(function() { // <-- Simulate network congestion, remove setTimeout from production!
				var el, li, i;
				el = document.querySelector("#wrapper ul");
				for(i = 0; i < 2; i++) {
					li = document.createElement('li');
					li.appendChild(document.createTextNode('async row ' + (++generatedCount)));
					el.appendChild(li, el.childNodes[0]);
				}
				wrapper.refresh(); /****remember to refresh after action completed！！！   ---id.refresh(); --- ****/
			}, 1000);
		}
	</script>

</html>